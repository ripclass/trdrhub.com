[tool:pytest]
# Pytest configuration for LCopilot Trust Platform regression tests

# Test discovery
testpaths = tests/regression
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Minimum version required
minversion = 6.0

# Add current directory to Python path for imports
addopts =
    -v
    --strict-markers
    --strict-config
    --tb=short
    --maxfail=10
    --durations=10
    --cov-config=.coveragerc

# Test markers for categorization
markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    critical: marks tests as critical for deployment
    security: marks tests related to security features
    rate_limiting: marks tests related to rate limiting
    integration: marks tests that test integration between services
    unit: marks tests as unit tests
    regression: marks tests as regression tests
    aws: marks tests that interact with AWS services (mocked)
    redis: marks tests that interact with Redis (mocked)
    async: marks tests that test async functionality
    cleanup: marks tests related to job and resource cleanup
    error_handling: marks tests related to error handling
    correlation: marks tests related to correlation IDs and tracing

# Test output formatting
console_output_style = progress

# Warnings configuration
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:moto.*
    ignore::ResourceWarning

# Logging configuration
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Coverage configuration (additional settings in .coveragerc)
norecursedirs = .git .tox dist build *.egg __pycache__

# JUnit XML configuration
junit_suite_name = LCopilot_Regression_Tests
junit_logging = all
junit_log_passing_tests = true
junit_duration_report = total

# HTML report configuration
html_theme = classic
html_self_contained = true
html_report_title = LCopilot Trust Platform - Phase 4.5 Regression Test Report
html_report_subtitle = Security Hardening Validation
html_report_header = LCopilot Trust Platform
html_report_footer = Generated by pytest-html

# Test collection configuration
collect_ignore = setup.py conftest.py

# Timeout configuration (prevents hanging tests)
timeout = 300
timeout_method = thread

# Parallel execution settings (if using pytest-xdist)
# addopts = -n auto  # Uncomment to enable parallel execution

# Mock configuration
mock_use_standalone_module = true